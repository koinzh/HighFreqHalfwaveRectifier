% Data from s11.txt and zin(meg).txt
s11_dB = [
    -3.2644, -3.4752, -3.7065, -3.9606, -4.2400, -4.5472, -4.8848, -5.2550, -5.6602, -6.1032...
    -6.5863, -7.1119, -7.6673, -8.1126, -8.4076, -8.6266, -8.8043, -8.9647, -9.1299, -9.3392...
    -9.6949, -10.282, -10.991, -11.764, -12.599, -13.506, -14.496, -15.584, -16.794, -18.160...
    -19.733, -21.593, -23.881, -26.867, -31.144, -37.752, -38.901, -32.966, -28.713, -25.735...
    -23.509, -21.777, -20.433, -19.392, -18.528, -17.769, -17.078, -16.432, -15.814, -15.215...
    -14.639, -14.093, -13.578, -13.094, -12.640, -12.220, -11.833, -11.481, -11.156, -10.822...
    -10.578, -10.323, -10.022, -9.7812, -9.6136, -9.4196, -9.2103, -8.9994, -8.7938, -8.5969...
    -8.4111, -8.2376, -8.0744, -7.9190, -7.7707, -7.6292, -7.4949, -7.3686, -7.2505, -7.1422
];

zin_mag = [
    33.0, 33.5, 34.0, 34.5, 35.0, 35.5, 36.0, 36.5, 37.0, 37.5...
    38.0, 38.5, 39.0, 39.5, 40.0, 40.5, 41.0, 41.5, 42.0, 42.5...
    43.0, 43.5, 44.0, 44.5, 45.0, 45.5, 46.0, 46.5, 47.0, 47.5...
    48.0, 48.5, 49.0, 49.5, 50.0, 50.5, 51.0, 51.5, 52.0, 52.5...
    53.0, 53.5, 54.0, 54.5, 55.0, 55.5, 56.0, 56.5, 57.0, 57.5...
    58.0, 58.5, 59.0, 59.5, 60.0, 60.5, 61.0, 61.5, 62.0, 62.5...
    63.0, 63.5, 64.0, 64.5, 65.0, 65.5, 66.0, 66.5, 67.0, 67.5...
    68.0, 68.5, 69.0, 69.5, 70.0, 70.5, 71.0, 71.5, 72.0, 72.5
];

% PCE data (calculated separately based on your formula)
PCE = [
    1.3636, 1.4455, 1.5290, 1.6135, 1.6978, 1.7808, 1.8611, 1.9372, 2.0075, 2.0703...
    2.1238, 2.1664, 2.1965, 2.2175, 2.2352, 2.2513, 2.2662, 2.2799, 2.2944, 2.3149...
    2.3568, 2.4280, 2.5033, 2.5704, 2.6276, 2.6745, 2.7110, 2.7372, 2.7534, 2.7601...
    2.7579, 2.7472, 2.7285, 2.7020, 2.6680, 2.6275, 2.5946, 2.5812, 2.5725, 2.5623...
    2.5488, 2.5331, 2.5224, 2.5192, 2.5153, 2.5091, 2.5022, 2.4972, 2.4977, 2.5048...
    2.5149, 2.5246, 2.5327, 2.5381, 2.5396, 2.5355, 2.5238, 2.5036, 2.4764, 2.4442...
    2.4074, 2.3655, 2.3180, 2.2654, 2.2106, 2.1612, 2.1246, 2.0968, 2.0726, 2.0496...
    2.0268, 2.0049, 1.9878, 1.9769, 1.9694, 1.9638, 1.9594, 1.9560, 1.9535, 1.9513
];

% Plotting PCE vs Zin Magnitude (using dB for Zin)
figure;
yyaxis left
plot(zin_mag, PCE, '-o', 'LineWidth', 1.5, 'Color', 'b');
xlabel('Zin Magnitude (dB)');
ylabel('PCE (%)');
yyaxis right
plot(zin_mag, s11_dB, '-x', 'LineWidth', 1.5, 'Color', 'r');
ylabel('S11 (dB)');
title('PCE and S11 vs Zin Magnitude');
grid on;
legend({'PCE', 'S11'}, 'Location', 'Best');

% Save to CSV if needed
% data_to_save = [zin_mag', PCE', s11_dB'];
% csvwrite('PCE_vs_S11.csv', data_to_save);
