% 数据导入
data = [
    0.600, 1.36359115491850535;
    0.610, 1.44547586799823602;
    0.620, 1.52904654232877091;
    0.630, 1.61348147675037312;
    0.640, 1.69778032199806650;
    0.650, 1.78079218906972181;
    0.660, 1.86113384792612990;
    0.670, 1.93724006701049656;
    0.680, 2.00752719549237080;
    0.690, 2.07030809497600954;
    0.700, 2.12384102113156681;
    0.710, 2.16638822225497840;
    0.720, 2.19650260072983006;
    0.730, 2.21745320307758265;
    0.740, 2.23517645187100422;
    0.750, 2.25132395607290992;
    0.760, 2.26617221916095257;
    0.770, 2.27997260857426509;
    0.780, 2.29440469757709886;
    0.790, 2.31491526574029560;
    0.800, 2.35683856404144310;
    0.810, 2.42801710726312514;
    0.820, 2.50327963030554823;
    0.830, 2.57038290279973491;
    0.840, 2.62759010453469299;
    0.850, 2.67450185014940400;
    0.860, 2.71098845806158906;
    0.870, 2.73715437148046981;
    0.880, 2.75338491384538964;
    0.890, 2.76013206299848557;
    0.900, 2.75791182147595171;
    0.910, 2.74722683651677491;
    0.920, 2.72849264510063438;
    0.930, 2.70200475783844629;
    0.940, 2.66798146869123087;
    0.950, 2.62751379136045760;
    0.960, 2.59462283566600682;
    0.970, 2.58119151056742036;
    0.980, 2.57253405108136279;
    0.990, 2.56230200246002404;
    1.000, 2.54882613911919309;
    1.010, 2.53314753956703687;
    1.020, 2.52240463885896737;
    1.030, 2.51917316607314978;
    1.040, 2.51527905309263744;
    1.050, 2.50911537741273261;
    1.060, 2.50221125937245059;
    1.070, 2.49719929072408586;
    1.080, 2.49765148687843030;
    1.090, 2.50479268499824537;
    1.100, 2.51487352271924491;
    1.110, 2.52462924242065201;
    1.120, 2.53268272864607979;
    1.130, 2.53807679668951991;
    1.140, 2.53960398807552457;
    1.150, 2.53553438995355362;
    1.160, 2.52383027906264656;
    1.170, 2.50362996638398938;
    1.180, 2.47643370228063686;
    1.190, 2.44417103970835647;
    1.200, 2.40742625141352384;
    1.210, 2.36554798329502391;
    1.220, 2.31796049880895705;
    1.230, 2.26544035142248390;
    1.240, 2.21060937547227709;
    1.250, 2.16116931135000678;
    1.260, 2.12459002145219067;
    1.270, 2.09677080940686134;
    1.280, 2.07257094783026030;
    1.290, 2.04955394103213706;
    1.300, 2.02675544056519197;
    1.310, 2.00489485333367279;
    1.320, 1.98782463756275818;
    1.330, 1.97685765590313367;
    1.340, 1.96940997076915392;
    1.350, 1.96382454204773782;
    1.360, 1.95943890341514515;
    1.370, 1.95602488938751229;
    1.380, 1.95354776342942760;
    1.390, 1.95196389788648372;
    1.400, 1.95130609829655466;
];

% 分离频率和输出直流功率数据
frequency = data(:, 1);  % 频率数据 (GHz)
P_out_DC_dBm = data(:, 2);  % 输出直流功率 (dBm)

% 将输出直流功率从dBm转换为线性功率（瓦特）
P_out_DC = 10.^((P_out_DC_dBm - 30)/10);

% 假设输入射频功率为10 dBm
P_in_RF_dBm = 10; % 输入射频功率 (dBm)

% 将输入射频功率转换为线性功率（瓦特）
P_in_RF = 10.^((P_in_RF_dBm - 30)/10); % 从dBm转换到瓦特

% 计算PCE
PCE = (P_out_DC ./ P_in_RF) * 100;

% 导出PCE和频率数据到CSV文件
output_data = [frequency, PCE];
writematrix(output_data, 'PCE_vs_Frequency.csv');

% 绘制PCE vs Frequency图表
figure;
plot(frequency, PCE, '-o', 'LineWidth', 1.5);
xlabel('Frequency (GHz)');
ylabel('PCE (%)');
title('PCE vs Frequency');
grid on;

% 设置X轴和Y轴的显示范围
xlim([min(frequency), max(frequency)]);
ylim([min(PCE)-5, max(PCE)+5]);

% 添加标记或注释
[maxPCE, idx] = max(PCE);
hold on;
plot(frequency(idx), maxPCE, 'ro', 'MarkerSize', 10);
text(frequency(idx), maxPCE, sprintf('Max PCE = %.2f%%', maxPCE), 'VerticalAlignment', 'bottom', 'HorizontalAlignment', 'right');
hold off;
